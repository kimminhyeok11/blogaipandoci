const ScriptLoader={loadedScripts:new Set,async loadScript(t,e={}){return this.loadedScripts.has(t)?Promise.resolve():new Promise((o,s)=>{const r=document.createElement("script");r.src=t,r.async=e.async!==!1,r.defer=e.defer||!1,e.nonce&&(r.nonce=e.nonce),r.onload=()=>{this.loadedScripts.add(t),o()},r.onerror=()=>{s(new Error(`Failed to load script: ${t}`))},document.head.appendChild(r)})},async loadCSS(t){return document.querySelector(`link[href="${t}"]`)?Promise.resolve():new Promise((e,o)=>{const s=document.createElement("link");s.rel="stylesheet",s.href=t,s.onload=e,s.onerror=()=>o(new Error(`Failed to load CSS: ${t}`)),document.head.appendChild(s)})},async loadEditorJS(){const t=["https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest","https://cdn.jsdelivr.net/npm/@editorjs/header@latest","https://cdn.jsdelivr.net/npm/@editorjs/list@latest","https://cdn.jsdelivr.net/npm/@editorjs/checklist@latest","https://cdn.jsdelivr.net/npm/@editorjs/quote@latest","https://cdn.jsdelivr.net/npm/@editorjs/code@latest","https://cdn.jsdelivr.net/npm/@editorjs/delimiter@latest","https://cdn.jsdelivr.net/npm/@editorjs/table@latest","https://cdn.jsdelivr.net/npm/@editorjs/link@latest","https://cdn.jsdelivr.net/npm/@editorjs/image@latest","https://cdn.jsdelivr.net/npm/editorjs-html@4.0.0/.build/edjsHTML.browser.js"];try{await Promise.all(t.map(e=>this.loadScript(e,{nonce:"r4nd0m"}))),console.log("Editor.js scripts loaded successfully")}catch(e){throw console.error("Failed to load Editor.js scripts:",e),e}},async loadUtilities(){const t=["https://cdn.jsdelivr.net/npm/dompurify@3.0.8/dist/purify.min.js","https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.0.8/purify.min.js","https://unpkg.com/dompurify@3.0.8/dist/purify.min.js"],e=["https://cdn.jsdelivr.net/npm/marked@12.0.2/lib/marked.umd.min.js","https://cdnjs.cloudflare.com/ajax/libs/marked/12.0.2/marked.min.js","https://unpkg.com/marked@12.0.2/lib/marked.umd.min.js"],o=async s=>{let r;for(const d of s)try{return await this.loadScript(d,{nonce:"r4nd0m"}),console.log("Loaded:",d),!0}catch(l){r=l,console.warn("Failed:",d,l)}throw r||new Error("All sources failed")};try{await o(t),await o(e),console.log("Utility scripts loaded successfully")}catch(s){throw console.error("Failed to load utility scripts:",s),s}},async loadAll(){try{await Promise.all([this.loadUtilities()]),console.log("All scripts loaded successfully")}catch(t){throw console.error("Failed to load scripts:",t),t}}};window.ScriptLoader=ScriptLoader;
